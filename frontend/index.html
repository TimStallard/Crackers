<DOCTYPE html>
<html>
  <head>
    <script src="/socket.io/socket.io.js"></script>
    <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
    <script>
    var time = 0;
    var max = 0;

    function handleMotion(e){
      acceleration = Math.sqrt(Math.pow(e.accelerationIncludingGravity.x, 2) + Math.pow(e.accelerationIncludingGravity.y, 2) + Math.pow(e.accelerationIncludingGravity.z, 2)) - 9.81;
      max = Math.max(acceleration, max);
    }
    window.addEventListener("devicemotion", handleMotion, true);
    </script>
  </head>
  <body>
    <style>
    .page{
      display: none;
    }
    </style>
    <div class="page" id="page-signup" style="display: block;">
      <form>
        <input type="text" placeholder="Name" name="name"></input>
        <input type="submit" value="Let's get cracking!"></input>
      </form>
    </div>
    <div class="page" id="page-main">
      <button id="getcode">Get a code</button>
      <button id="entercode">Enter a code</button>
    </div>
    <div class="page" id="page-getcode">

    </div>
    <div class="page" id="page-entercode">
      <form>
        <input type="text" placeholder="Your code" name="code"></input>
        <input type="submit" value="Go!"></input>
      </form>
    </div>
    <div class="page" id="page-force">
      Actual game will go here
    </div>
    <div class="page" id="page-complete">

    </div>

    <script>
      var socket = io.connect();

      $("#page-signup>form").submit(function(e){
        e.preventDefault();
        socket.emit("signup", {
          name: $("#page-signup>form>input[name='name']").val()
        });
      });

      socket.on("id", function(id){
        $(".page").hide();
        $("#page-main").show();
      });

      $("#page-main>button#getcode").click(function(){
        socket.emit("getcode");
      });

      $("#page-main>button#entercode").click(function(){
        $(".page").hide();
        $("#page-entercode").show();
      });

      socket.on("code", function(code){
        $(".page").hide();
        $("#page-getcode").show();
        $("#page-getcode").html("Your code is: " + code);
      });

      $("#page-entercode>form").submit(function(e){
        e.preventDefault();
        socket.emit("submitcode", $("#page-entercode>form>input[name='code']").val());
      });

      socket.on("start", function(){
        $(".page").hide();
        $("#page-force").show();
      });
    </script>
  </body>
</html>
